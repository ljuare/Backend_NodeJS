<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Formulario HTML</title>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	</head>
	<body class="container">
		<h1>Formulario HTML</h1>
		<form action="http://localhost:3000/enviar" method="post">

			<label for="nombre">Ingrese su nombre:</label>
			<input class="form-control" type="text" name="nombre" placeholder="Ej: Obi Juan Kenobi">
			
			<br>

			<label for="correo">Ingrese su E-Mail:</label>
			<input class="form-control" type="email" name="correo" placeholder="Ej: obi.juan@jedi.com">

			<br>

			<label for="asunto">Elija su asunto:</label>
			<select class="form-control" name="asunto">
				<option value="ax45">Consulta</option>
				<option value="ax38">Pedido</option>
				<option value="ax67">Sugerencia</option>
				<option value="ax14">Reclamo</option>
			</select>

			<br>

			<label for="mensaje">Ingrese su mensaje:</label>
			<textarea class="form-control" name="mensaje" cols="30" rows="10" placeholder="Max: 100 caracteres"></textarea>

			<br>

			<input class="btn btn-primary" type="submit" value="Done!">

		</form>

		<script>
			document.querySelector("form").addEventListener("submit", function(evento){ // Addeventlistener es lo mismo que hacer onsubmit con la diferencia que el primero admite muchas funcioens por evento y el segundo solo una
				evento.preventDefault() // Con preventDefault JS se mete en el formulario e interrumpe el comportamiento predeterminado que es enviar la información, por lo cual podres modificar algo antes de permitir que se envíe la información.

				const datos = Object.fromEntries( new FormData(evento.target)) // Esta función va a agarrar los datos del formulario. La propiedad target del parámetro evento es una referencia del objeto que lo provocó, es decir, el "form"
				// console.log(datos)
				// const datos = new FormData(this) Tambien se podría poner asi.

				fetch(evento.target.action, { // El action es donde me especificó la ruta arriba, a donde el formulario debe enviar los datos
					method : evento.target.method, // Configuro como va a enviar los datos. Se llama method porque es el atributo method que tengo arriba
					body : JSON.stringify(datos), // Pasar de object a JSON
					headers : {
						"Content-Type" : "application/json"
					}, // Configuro que datos va a enviar. Son los datos que obtuvo en el index.js					
				}).then( rta => rta.json() ).then(data => {
					alert( data.rta )
				})
			})
		</script>
	</body>
</html>
